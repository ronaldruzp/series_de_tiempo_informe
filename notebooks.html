
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Análisis exploratorio. &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Notebooks with MyST Markdown" href="markdown-notebooks.html" />
    <link rel="prev" title="Markdown Files" href="markdown.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="My sample book - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="markdown.html">Markdown Files</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Análisis exploratorio.</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fnotebooks.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/notebooks.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Análisis exploratorio.</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion-y-contexto">1. Introducción y contexto</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-preliminar">2 Análisis preliminar</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspeccion-general">2.1 Inspección general</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estadistica-descriptiva">2.2 Estadística descriptiva</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-la-serie">3 Visualizacion de la serie</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-temporal">3.1 Visualizacion temporal</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-componentes">3.2 Análisis de componentes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#descomposicion-clasica-aditiva">Descomposición clásica (aditiva).</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#descomposicion-stl">Descomposicion STL</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-de-anomalias">Detección de anomalías</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estacionalidad-y-periodicidad">4 Estacionalidad y periodicidad</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-patrones-recurrentes">4.1. Análisis de patrones recurrentes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-tendencia">5 Análisis de tendencia</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agrupados-por-dias">Agrupados por dias</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agrupando-por-ventas-diarias">Agrupando por ventas diarias</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-la-media-y-varianza-en-submuestras-evaluar-si-cambian-con-el-tiempo">Visualización de la media y varianza en submuestras: Evaluar si cambian con el tiempo.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transformaciones-de-datos">6.2. Transformaciones de datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-multivariado">7. Análisis multivariado</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#identificacion-de-ciclos-y-frecuencias">8. Identificación de ciclos y frecuencias</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-de-anomalias-y-eventos-extremos">9. Detección de anomalías y eventos extremos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen-y-recomendaciones">10. Resumen y recomendaciones</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analisis-exploratorio">
<h1>Análisis exploratorio.<a class="headerlink" href="#analisis-exploratorio" title="Link to this heading">#</a></h1>
<section id="introduccion-y-contexto">
<h2>1. Introducción y contexto<a class="headerlink" href="#introduccion-y-contexto" title="Link to this heading">#</a></h2>
<p>El análisis exploratorio de datos (EDA) tiene como objetivo entender cómo se comportan las ventas registradas en la base de datos Online Retail II de la UCI Machine Learning Repository. Con este análisis queremos identificar patrones como tendencias o estacionalidades, así como detectar posibles anomalías que podrían afectar futuros modelos de predicción. Esto nos ayudará a conocer mejor la estructura de los datos y prepararlos para análisis más avanzados.</p>
<p>La base de datos utilizada proviene de transacciones realizadas por una tienda en línea entre 2009 y 2011 con registros detallados por cada transacción. Para el análisis, agrupamos las ventas de forma diaria para estudiar el comportamiento general. Las unidades de medida corresponden a la cantidad de productos vendidos. La serie cubre un periodo de aproximadamente dos años, lo que permite observar variaciones a lo largo del tiempo, incluyendo posibles ciclos estacionales o eventos especiales.</p>
<p>El conjunto de datos completo incluye 1,044,848 registros después de combinar los datos de ambos años, proporcionando un panorama más amplio de las ventas en ese período.</p>
<p>Las variables principales son:</p>
<p>Invoice: Número de la factura que identifica cada transacción.
StockCode: Código del producto vendido.
Description: Descripción del producto.
Quantity: Cantidad de productos vendidos en cada transacción.
InvoiceDate: Fecha y hora en que se realizó la transacción.
Price: Precio unitario del producto.
Customer ID: Identificador único del cliente.
Country: País desde donde se realizó la compra.</p>
<p>Para el análisis exploratorio, nos enfocamos en la variable Quantity (cantidad de productos vendidos) y InvoiceDate (fecha de la transacción), agrupando los datos a nivel diario para identificar patrones en el comportamiento de las ventas a lo largo del tiempo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.seasonal</span><span class="w"> </span><span class="kn">import</span> <span class="n">seasonal_decompose</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.seasonal</span><span class="w"> </span><span class="kn">import</span> <span class="n">STL</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.graphics.tsaplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_acf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.graphics.tsaplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_pacf</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ruta</span> <span class="o">=</span> <span class="s2">&quot;C:/Users/ronal/Downloads/online_retail_II.xlsx&quot;</span>

<span class="n">sheets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">ruta</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;openpyxl&quot;</span><span class="p">)</span> <span class="c1">#Con este cpdogp se leeran todas las hojas del excel</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">sheets</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Unir todas las hojas en un solo DataFrame</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">ruta</span> <span class="o">=</span> <span class="s2">&quot;C:/Users/ronal/Downloads/online_retail_II.xlsx&quot;</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">sheets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">ruta</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;openpyxl&quot;</span><span class="p">)</span> <span class="c1">#Con este cpdogp se leeran todas las hojas del excel</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">sheets</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Unir todas las hojas en un solo DataFrame</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="nn">File ~\miniconda3\envs\series_de_tiempo\lib\site-packages\pandas\io\excel\_base.py:508,</span> in <span class="ni">read_excel</span><span class="nt">(io, sheet_name, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skiprows, nrows, na_values, keep_default_na, na_filter, verbose, parse_dates, date_parser, date_format, thousands, decimal, comment, skipfooter, storage_options, dtype_backend, engine_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">502</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">503</span>         <span class="s2">&quot;Engine should not be specified when passing &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">504</span>         <span class="s2">&quot;an ExcelFile - ExcelFile already has the engine set&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">505</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">507</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">508</span>     <span class="n">data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">509</span>         <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">510</span>         <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">511</span>         <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">512</span>         <span class="n">index_col</span><span class="o">=</span><span class="n">index_col</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">513</span>         <span class="n">usecols</span><span class="o">=</span><span class="n">usecols</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">514</span>         <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">515</span>         <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">516</span>         <span class="n">true_values</span><span class="o">=</span><span class="n">true_values</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">517</span>         <span class="n">false_values</span><span class="o">=</span><span class="n">false_values</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">518</span>         <span class="n">skiprows</span><span class="o">=</span><span class="n">skiprows</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">519</span>         <span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">520</span>         <span class="n">na_values</span><span class="o">=</span><span class="n">na_values</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">521</span>         <span class="n">keep_default_na</span><span class="o">=</span><span class="n">keep_default_na</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">522</span>         <span class="n">na_filter</span><span class="o">=</span><span class="n">na_filter</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">523</span>         <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">524</span>         <span class="n">parse_dates</span><span class="o">=</span><span class="n">parse_dates</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">525</span>         <span class="n">date_parser</span><span class="o">=</span><span class="n">date_parser</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">526</span>         <span class="n">date_format</span><span class="o">=</span><span class="n">date_format</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">527</span>         <span class="n">thousands</span><span class="o">=</span><span class="n">thousands</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">528</span>         <span class="n">decimal</span><span class="o">=</span><span class="n">decimal</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">529</span>         <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">530</span>         <span class="n">skipfooter</span><span class="o">=</span><span class="n">skipfooter</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">531</span>         <span class="n">dtype_backend</span><span class="o">=</span><span class="n">dtype_backend</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">532</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">533</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">534</span>     <span class="c1"># make sure to close opened file handles</span>
<span class="g g-Whitespace">    </span><span class="mi">535</span>     <span class="k">if</span> <span class="n">should_close</span><span class="p">:</span>

<span class="nn">File ~\miniconda3\envs\series_de_tiempo\lib\site-packages\pandas\io\excel\_base.py:1616,</span> in <span class="ni">ExcelFile.parse</span><span class="nt">(self, sheet_name, header, names, index_col, usecols, converters, true_values, false_values, skiprows, nrows, na_values, parse_dates, date_parser, date_format, thousands, comment, skipfooter, dtype_backend, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1576</span> <span class="k">def</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1577</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1578</span>     <span class="n">sheet_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1596</span>     <span class="o">**</span><span class="n">kwds</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1597</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">]</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">]:</span>
<span class="g g-Whitespace">   </span><span class="mi">1598</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1599</span><span class="sd">     Parse specified sheet(s) into a DataFrame.</span>
<span class="g g-Whitespace">   </span><span class="mi">1600</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">1614</span><span class="sd">     &gt;&gt;&gt; file.parse()  # doctest: +SKIP</span>
<span class="g g-Whitespace">   </span><span class="mi">1615</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1616</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reader</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1617</span>         <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1618</span>         <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1619</span>         <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1620</span>         <span class="n">index_col</span><span class="o">=</span><span class="n">index_col</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1621</span>         <span class="n">usecols</span><span class="o">=</span><span class="n">usecols</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1622</span>         <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1623</span>         <span class="n">true_values</span><span class="o">=</span><span class="n">true_values</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1624</span>         <span class="n">false_values</span><span class="o">=</span><span class="n">false_values</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1625</span>         <span class="n">skiprows</span><span class="o">=</span><span class="n">skiprows</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1626</span>         <span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1627</span>         <span class="n">na_values</span><span class="o">=</span><span class="n">na_values</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1628</span>         <span class="n">parse_dates</span><span class="o">=</span><span class="n">parse_dates</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1629</span>         <span class="n">date_parser</span><span class="o">=</span><span class="n">date_parser</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1630</span>         <span class="n">date_format</span><span class="o">=</span><span class="n">date_format</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1631</span>         <span class="n">thousands</span><span class="o">=</span><span class="n">thousands</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1632</span>         <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1633</span>         <span class="n">skipfooter</span><span class="o">=</span><span class="n">skipfooter</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1634</span>         <span class="n">dtype_backend</span><span class="o">=</span><span class="n">dtype_backend</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1635</span>         <span class="o">**</span><span class="n">kwds</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1636</span>     <span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\series_de_tiempo\lib\site-packages\pandas\io\excel\_base.py:778,</span> in <span class="ni">BaseExcelReader.parse</span><span class="nt">(self, sheet_name, header, names, index_col, usecols, dtype, true_values, false_values, skiprows, nrows, na_values, verbose, parse_dates, date_parser, date_format, thousands, decimal, comment, skipfooter, dtype_backend, **kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">775</span>     <span class="n">sheet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sheet_by_index</span><span class="p">(</span><span class="n">asheetname</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">777</span> <span class="n">file_rows_needed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_rows</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">index_col</span><span class="p">,</span> <span class="n">skiprows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">778</span> <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sheet_data</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">file_rows_needed</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">779</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">780</span>     <span class="c1"># pyxlsb opens two TemporaryFiles</span>
<span class="g g-Whitespace">    </span><span class="mi">781</span>     <span class="n">sheet</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="nn">File ~\miniconda3\envs\series_de_tiempo\lib\site-packages\pandas\io\excel\_openpyxl.py:615,</span> in <span class="ni">OpenpyxlReader.get_sheet_data</span><span class="nt">(self, sheet, file_rows_needed)</span>
<span class="g g-Whitespace">    </span><span class="mi">613</span> <span class="n">data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Scalar</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">    </span><span class="mi">614</span> <span class="n">last_row_with_data</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="ne">--&gt; </span><span class="mi">615</span> <span class="k">for</span> <span class="n">row_number</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">616</span>     <span class="n">converted_row</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_convert_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">617</span>     <span class="k">while</span> <span class="n">converted_row</span> <span class="ow">and</span> <span class="n">converted_row</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">618</span>         <span class="c1"># trim trailing empty elements</span>

<span class="nn">File ~\miniconda3\envs\series_de_tiempo\lib\site-packages\openpyxl\worksheet\_read_only.py:85,</span> in <span class="ni">ReadOnlyWorksheet._cells_by_row</span><span class="nt">(self, min_col, min_row, max_col, max_row, values_only)</span>
<span class="g g-Whitespace">     </span><span class="mi">77</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_source</span><span class="p">()</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">78</span>     <span class="n">parser</span> <span class="o">=</span> <span class="n">WorkSheetParser</span><span class="p">(</span><span class="n">src</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">79</span>                              <span class="bp">self</span><span class="o">.</span><span class="n">_shared_strings</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">80</span>                              <span class="n">data_only</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">data_only</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">81</span>                              <span class="n">epoch</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">epoch</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">82</span>                              <span class="n">date_formats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">_date_formats</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">83</span>                              <span class="n">timedelta_formats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">_timedelta_formats</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">85</span>     <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">():</span>
<span class="g g-Whitespace">     </span><span class="mi">86</span>         <span class="k">if</span> <span class="n">max_row</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">idx</span> <span class="o">&gt;</span> <span class="n">max_row</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">87</span>             <span class="k">break</span>

<span class="nn">File ~\miniconda3\envs\series_de_tiempo\lib\site-packages\openpyxl\worksheet\_reader.py:156,</span> in <span class="ni">WorkSheetParser.parse</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">137</span> <span class="n">properties</span> <span class="o">=</span> <span class="p">{</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span>     <span class="n">PRINT_TAG</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;print_options&#39;</span><span class="p">,</span> <span class="n">PrintOptions</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">139</span>     <span class="n">MARGINS_TAG</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;page_margins&#39;</span><span class="p">,</span> <span class="n">PageMargins</span><span class="p">),</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span> 
<span class="g g-Whitespace">    </span><span class="mi">152</span> <span class="p">}</span>
<span class="g g-Whitespace">    </span><span class="mi">154</span> <span class="n">it</span> <span class="o">=</span> <span class="n">iterparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span> <span class="c1"># add a finaliser to close the source when this becomes possible</span>
<span class="ne">--&gt; </span><span class="mi">156</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">157</span>     <span class="n">tag_name</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">tag</span>
<span class="g g-Whitespace">    </span><span class="mi">158</span>     <span class="k">if</span> <span class="n">tag_name</span> <span class="ow">in</span> <span class="n">dispatcher</span><span class="p">:</span>

<span class="nn">File ~\miniconda3\envs\series_de_tiempo\lib\xml\etree\ElementTree.py:1255,</span> in <span class="ni">iterparse.&lt;locals&gt;.iterator</span><span class="nt">(source)</span>
<span class="g g-Whitespace">   </span><span class="mi">1253</span> <span class="k">yield from</span> <span class="n">pullparser</span><span class="o">.</span><span class="n">read_events</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1254</span> <span class="c1"># load event buffer</span>
<span class="ne">-&gt; </span><span class="mi">1255</span> <span class="n">data</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">16</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1256</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1257</span>     <span class="k">break</span>

<span class="nn">File ~\miniconda3\envs\series_de_tiempo\lib\zipfile.py:926,</span> in <span class="ni">ZipExtFile.read</span><span class="nt">(self, n)</span>
<span class="g g-Whitespace">    </span><span class="mi">924</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span> <span class="o">=</span> <span class="mi">0</span>
<span class="g g-Whitespace">    </span><span class="mi">925</span> <span class="k">while</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eof</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">926</span>     <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">927</span>     <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">928</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_readbuffer</span> <span class="o">=</span> <span class="n">data</span>

<span class="nn">File ~\miniconda3\envs\series_de_tiempo\lib\zipfile.py:1002,</span> in <span class="ni">ZipExtFile._read1</span><span class="nt">(self, n)</span>
<span class="g g-Whitespace">   </span><span class="mi">1000</span> <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compress_type</span> <span class="o">==</span> <span class="n">ZIP_DEFLATED</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1001</span>     <span class="n">n</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MIN_READ_SIZE</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1002</span>     <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decompressor</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1003</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_eof</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_decompressor</span><span class="o">.</span><span class="n">eof</span> <span class="ow">or</span>
<span class="g g-Whitespace">   </span><span class="mi">1004</span>                  <span class="bp">self</span><span class="o">.</span><span class="n">_compress_left</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">and</span>
<span class="g g-Whitespace">   </span><span class="mi">1005</span>                  <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decompressor</span><span class="o">.</span><span class="n">unconsumed_tail</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1006</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eof</span><span class="p">:</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span> <span class="c1"># Al unir las hojas se duplicaron algunas filas, este codigo eliminara las filas duplicadas</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="analisis-preliminar">
<h2>2 Análisis preliminar<a class="headerlink" href="#analisis-preliminar" title="Link to this heading">#</a></h2>
<section id="inspeccion-general">
<h3>2.1 Inspección general<a class="headerlink" href="#inspeccion-general" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Column names:&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="c1">#Nombre de las variables</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column names: Index([&#39;Invoice&#39;, &#39;StockCode&#39;, &#39;Description&#39;, &#39;Quantity&#39;, &#39;InvoiceDate&#39;,
       &#39;Price&#39;, &#39;Customer ID&#39;, &#39;Country&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No. of rows, columns:&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="c1">#Numero de filas y columnas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No. of rows, columns: (1033036, 8)
</pre></div>
</div>
</div>
</div>
<p>El dataframe tiene 8 variables y 1033036 observaciones</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Invoice StockCode                          Description  Quantity  \
0  489434     85048  15CM CHRISTMAS GLASS BALL 20 LIGHTS        12   
1  489434    79323P                   PINK CHERRY LIGHTS        12   
2  489434    79323W                  WHITE CHERRY LIGHTS        12   
3  489434     22041         RECORD FRAME 7&quot; SINGLE SIZE         48   
4  489434     21232       STRAWBERRY CERAMIC TRINKET BOX        24   

          InvoiceDate  Price  Customer ID         Country  
0 2009-12-01 07:45:00   6.95      13085.0  United Kingdom  
1 2009-12-01 07:45:00   6.75      13085.0  United Kingdom  
2 2009-12-01 07:45:00   6.75      13085.0  United Kingdom  
3 2009-12-01 07:45:00   2.10      13085.0  United Kingdom  
4 2009-12-01 07:45:00   1.25      13085.0  United Kingdom  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        Invoice StockCode                      Description  Quantity  \
1067366  581587     22899     CHILDREN&#39;S APRON DOLLY GIRL          6   
1067367  581587     23254    CHILDRENS CUTLERY DOLLY GIRL          4   
1067368  581587     23255  CHILDRENS CUTLERY CIRCUS PARADE         4   
1067369  581587     22138    BAKING SET 9 PIECE RETROSPOT          3   
1067370  581587      POST                          POSTAGE         1   

                InvoiceDate  Price  Customer ID Country  
1067366 2011-12-09 12:50:00   2.10      12680.0  France  
1067367 2011-12-09 12:50:00   4.15      12680.0  France  
1067368 2011-12-09 12:50:00   4.15      12680.0  France  
1067369 2011-12-09 12:50:00   4.95      12680.0  France  
1067370 2011-12-09 12:50:00  18.00      12680.0  France  
</pre></div>
</div>
</div>
</div>
<p>Podemos observar que las observaciones inician el primero de enero del 2009 (01/01/2009) y finalizan el 09 de diciembre del 2011 (09/12/2011). Por tanto los datos tienen una coherencia temporal</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="c1">#Deteccion de valores faltantes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Invoice             0
StockCode           0
Description      4275
Quantity            0
InvoiceDate         0
Price               0
Customer ID    235151
Country             0
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>La columna Description cuenta con 4275 valores faltantes y la columna Customer ID tiene 235151.sin embargo, Descrition y Customer ID no afectan el análisis, por tanto podemos eliminar estas dos columna.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Customer ID&#39;</span><span class="p">])</span> <span class="c1">#Por comodidad llamaremos data2, al df al cual le eliminamos las columnas inncesarias</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">data2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data2</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Invoice StockCode  Quantity         InvoiceDate  Price         Country
0  489434     85048        12 2009-12-01 07:45:00   6.95  United Kingdom
1  489434    79323P        12 2009-12-01 07:45:00   6.75  United Kingdom
2  489434    79323W        12 2009-12-01 07:45:00   6.75  United Kingdom
3  489434     22041        48 2009-12-01 07:45:00   2.10  United Kingdom
4  489434     21232        24 2009-12-01 07:45:00   1.25  United Kingdom
</pre></div>
</div>
</div>
</div>
<p>Las variables “Customer ID” y “Description” fuerine eliminadas satisfactoriamente</p>
</section>
<section id="estadistica-descriptiva">
<h3>2.2 Estadística descriptiva<a class="headerlink" href="#estadistica-descriptiva" title="Link to this heading">#</a></h3>
<p>El objetivo de este análisis es predecir la cantidad de compras, por tanto la estadística descriptiva se realizara en la variable Quantity (cantidad)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">promedio</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">mediana</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">desviacion_std</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">minimo</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">maximo</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">percentiles</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>  

<span class="c1"># Imprimir los resultados</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Promedio: </span><span class="si">{</span><span class="n">promedio</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mediana: </span><span class="si">{</span><span class="n">mediana</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Desviación Estándar: </span><span class="si">{</span><span class="n">desviacion_std</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mínimo: </span><span class="si">{</span><span class="n">minimo</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Máximo: </span><span class="si">{</span><span class="n">maximo</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Percentiles:</span><span class="se">\n</span><span class="si">{</span><span class="n">percentiles</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Promedio: 10.076879218149223
Mediana: 3.0
Desviación Estándar: 175.19762799701013
Mínimo: -80995
Máximo: 80995
Percentiles:
0.25     1.0
0.50     3.0
0.75    10.0
Name: Quantity, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Podemos observar que la media de es de 10.0768, es decir, que por transacción se están vendiendo al redero de 10 artículos, sin embargo, la desviación estándar es extremadamente alto (175.1976) en comparación con la media y la mediana, lo que indica una gran variabilidad en los datos. El valor máximo es 80995 y el valor mínimo es -80995, partiendo del hecho de que los valores negativos indican devoluciones, esto quiere decir, la compra con mayor cantidad de objetos fue devuelta. La mayoría de los datos están concentrados en valores bajos, como lo muestran los percentiles: el 25% de las observaciones están por debajo de 1, el 50% por debajo de 3 y el 75% por debajo de 10. Estos resultados indican que, aunque la mayoría de las transacciones involucran cantidades pequeñas, la presencia de valores extremos distorsiona las medidas tradicionales de tendencia central.</p>
<p>Como nos interesa analizar el número de ventas y no el número de devoluciones, eliminaremos los valores negativos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data3</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[</span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="c1"># Eliminacion de valores negativos en la variable Quantity, ademas, ahora  el df se llama data3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No. of rows, columns:&#39;</span><span class="p">,</span> <span class="n">data3</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="c1">#Numero de filas y columnas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No. of rows, columns: (1010540, 6)
</pre></div>
</div>
</div>
</div>
<p>Al eliminar las filas con valores negativos en la cantidad (Quantity), obtendremos 1010540 observaciones. Además, también se eliminaron las variables irrelevantes, por tanto ahora tendremos 6</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q1</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>  <span class="c1"># Primer cuartil (Q1)</span>
<span class="n">Q3</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>  <span class="c1"># Tercer cuartil (Q3)</span>
<span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>  <span class="c1"># Rango intercuartílico</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rango Intercuartílico (IQR): </span><span class="si">{</span><span class="n">IQR</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rango Intercuartílico (IQR): 11.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">],</span> <span class="n">vert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Boxplot de la Cantidad de Compras&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Cantidad&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bd600010eb0c83a064ba0713e0e7ae76d5ce2b890722bbdd555cdd8ba48d19fd.png" src="_images/bd600010eb0c83a064ba0713e0e7ae76d5ce2b890722bbdd555cdd8ba48d19fd.png" />
</div>
</div>
<p>En el Box plot se observa que la mayoria de las compras se concentran en valores pequeños, sin embarrgo la escala se ve afectada por los valores extremos (mas de 80000 compras), los cuales indican que ciertos dias se hicieron compras muy grandes</p>
</section>
</section>
<section id="visualizacion-de-la-serie">
<h2>3 Visualizacion de la serie<a class="headerlink" href="#visualizacion-de-la-serie" title="Link to this heading">#</a></h2>
<section id="visualizacion-temporal">
<h3>3.1 Visualizacion temporal<a class="headerlink" href="#visualizacion-temporal" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Asegurarse de que la columna &#39;InvoiceDate&#39; esté en formato datetime</span>
<span class="n">data3</span><span class="p">[</span><span class="s1">&#39;InvoiceDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data3</span><span class="p">[</span><span class="s1">&#39;InvoiceDate&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>

<span class="c1"># Establecer &#39;InvoiceDate&#39; como el índice del DataFrame</span>
<span class="n">data3</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;InvoiceDate&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Aplicar el remuestreo para obtener la media diaria de &#39;Quantity&#39;</span>
<span class="n">daily</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">daily_mean</span> <span class="o">=</span> <span class="n">daily</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Visualizar la serie original (por transacción) y la media diaria</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Graficar la cantidad original (ventas por transacción)</span>
<span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ventas por transacción&#39;</span><span class="p">)</span>

<span class="c1"># Graficar la media diaria</span>
<span class="n">daily_mean</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Media diaria de ventas&#39;</span><span class="p">)</span>

<span class="c1"># Configurar el gráfico</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ventas por transacción (azul) y Media diaria (rojo)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cantidad de productos vendidos&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ronal\AppData\Local\Temp\ipykernel_5780\818573956.py:6: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data3[&#39;InvoiceDate&#39;] = pd.to_datetime(data3[&#39;InvoiceDate&#39;], format=&#39;%Y-%m-%d %H:%M:%S&#39;)
</pre></div>
</div>
<img alt="_images/2cb5fd22a7712aeefc793f3e86d72e0e3b96c1b45950e05912f7e37c937c707a.png" src="_images/2cb5fd22a7712aeefc793f3e86d72e0e3b96c1b45950e05912f7e37c937c707a.png" />
</div>
</div>
<p>Las líneas azules representan las ventas por transacción, a finales del 2011 se observan picos extremos, al igual que en el boxplot, se observan compras extremadamente altas, estas compras podrían indicar errores en el registro de los datos o valores atípicos los cuales se deben analizar más a fondo. A pesar de estas fluctuaciones extremas, el comportamiento general de las ventas parece mantenerse consistente a lo largo del tiempo. Por otro lado, la línea roja, que representa la media diaria de ventas, muestra una tendencia estable y constante, lo que sugiere que, en promedio, las ventas diarias no se ven afectadas significativamente por estos eventos aislados.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Remuestreo por hora para obtener la suma de ventas por hora</span>
<span class="n">ventas_por_hora</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Calcular la media diaria de las ventas por hora</span>
<span class="n">media_diaria_por_hora</span> <span class="o">=</span> <span class="n">ventas_por_hora</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Visualización de las ventas por hora y su media diaria</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Graficar las ventas por hora</span>
<span class="n">ventas_por_hora</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ventas por hora&#39;</span><span class="p">)</span>

<span class="c1"># Graficar la media diaria de las ventas por hora</span>
<span class="n">media_diaria_por_hora</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Media diaria de ventas por hora&#39;</span><span class="p">)</span>

<span class="c1"># Configuración del gráfico</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ventas por hora (azul) y Media diaria de ventas por hora (rojo)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cantidad de productos vendidos&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ronal\AppData\Local\Temp\ipykernel_5780\140281517.py:4: FutureWarning: &#39;H&#39; is deprecated and will be removed in a future version, please use &#39;h&#39; instead.
  ventas_por_hora = data3[&#39;Quantity&#39;].resample(&#39;H&#39;).sum()
</pre></div>
</div>
<img alt="_images/b74f9c67e7cbf8cf3e16eb7aee0ac62b8d78516cd553f000c734f430cd4915ab.png" src="_images/b74f9c67e7cbf8cf3e16eb7aee0ac62b8d78516cd553f000c734f430cd4915ab.png" />
</div>
</div>
<p>La gráfica muestra que las ventas por hora presentan alta variabilidad con picos que superan las 80,000 unidades, posiblemente debido a pedidos mayoristas, devoluciones masivas o errores de registro. Sin embargo, la media diaria de ventas por hora se mantiene estable, indicando que estas fluctuaciones extremas no afectan significativamente el comportamiento general de las ventas, que permanece uniforme a lo largo del tiempo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Remuestreo por día para obtener la suma de ventas diarias</span>
<span class="n">ventas_por_dia</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Calcular la media mensual de las ventas diarias para suavizar la serie</span>
<span class="n">media_mensual_por_dia</span> <span class="o">=</span> <span class="n">ventas_por_dia</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Visualización de las ventas por día y su media mensual</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Graficar las ventas por día</span>
<span class="n">ventas_por_dia</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ventas por día&#39;</span><span class="p">)</span>

<span class="c1"># Graficar la media mensual de las ventas diarias</span>
<span class="n">media_mensual_por_dia</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Media mensual de ventas diarias&#39;</span><span class="p">)</span>

<span class="c1"># Configuración del gráfico</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ventas diarias (azul) y Media mensual de ventas diarias (rojo)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cantidad de productos vendidos&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ronal\AppData\Local\Temp\ipykernel_5780\1945956961.py:7: FutureWarning: &#39;M&#39; is deprecated and will be removed in a future version, please use &#39;ME&#39; instead.
  media_mensual_por_dia = ventas_por_dia.resample(&#39;M&#39;).mean()
</pre></div>
</div>
<img alt="_images/4f015de09d37967ebe442d11c691790f6972257a13b609acd504813482673d1f.png" src="_images/4f015de09d37967ebe442d11c691790f6972257a13b609acd504813482673d1f.png" />
</div>
</div>
<p>El gráfico muestra que, aunque las ventas diarias (línea azul) son muy variables con picos significativos, la media mensual (línea roja) refleja una tendencia general de crecimiento, especialmente hacia finales de 2011. Los picos podrían deberse a eventos especiales o errores en los datos, mientras que la variación mensual sugiere posibles patrones estacionales.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Remuestreo por semana para obtener la suma de ventas semanales</span>
<span class="n">ventas_por_semana</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Calcular la media mensual de las ventas semanales para suavizar la serie</span>
<span class="n">media_mensual_por_semana</span> <span class="o">=</span> <span class="n">ventas_por_semana</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Visualización de las ventas por semana y su media mensual</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Graficar las ventas por semana</span>
<span class="n">ventas_por_semana</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ventas por semana&#39;</span><span class="p">)</span>

<span class="c1"># Graficar la media mensual de las ventas semanales</span>
<span class="n">media_mensual_por_semana</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Media mensual de ventas semanales&#39;</span><span class="p">)</span>

<span class="c1"># Configuración del gráfico</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ventas semanales (azul) y Media mensual de ventas semanales (rojo)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cantidad de productos vendidos&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ronal\AppData\Local\Temp\ipykernel_5780\19447228.py:7: FutureWarning: &#39;M&#39; is deprecated and will be removed in a future version, please use &#39;ME&#39; instead.
  media_mensual_por_semana = ventas_por_semana.resample(&#39;M&#39;).mean()
</pre></div>
</div>
<img alt="_images/9157200d72bb479932b402a91e53c13f39cd9b93b070a12311d353705e50c5fa.png" src="_images/9157200d72bb479932b402a91e53c13f39cd9b93b070a12311d353705e50c5fa.png" />
</div>
</div>
<p>El gráfico muestra que las ventas semanales (línea azul) son inestables, con varios picos a lo largo del tiempo. Sin embargo, la media mensual (línea roja) sugiere una tendencia general al alza, especialmente a partir de mediados de 2011. Aunque hay caídas en algunos periodos, el crecimiento en las ventas es evidente hacia el final del gráfico.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remuestreo por mes para obtener la suma de ventas mensuales</span>
<span class="n">ventas_por_mes</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Calcular la media trimestral de las ventas mensuales para suavizar aún más la serie</span>
<span class="n">media_trimestral_por_mes</span> <span class="o">=</span> <span class="n">ventas_por_mes</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Visualización de las ventas por mes y su media trimestral</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Graficar las ventas por mes</span>
<span class="n">ventas_por_mes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ventas por mes&#39;</span><span class="p">)</span>

<span class="c1"># Graficar la media trimestral de las ventas mensuales</span>
<span class="n">media_trimestral_por_mes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Media trimestral de ventas mensuales&#39;</span><span class="p">)</span>

<span class="c1"># Configuración del gráfico</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ventas mensuales (azul) y Media trimestral de ventas mensuales (rojo)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cantidad de productos vendidos&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ronal\AppData\Local\Temp\ipykernel_5780\3446522307.py:2: FutureWarning: &#39;M&#39; is deprecated and will be removed in a future version, please use &#39;ME&#39; instead.
  ventas_por_mes = data3[&#39;Quantity&#39;].resample(&#39;M&#39;).sum()
C:\Users\ronal\AppData\Local\Temp\ipykernel_5780\3446522307.py:5: FutureWarning: &#39;Q&#39; is deprecated and will be removed in a future version, please use &#39;QE&#39; instead.
  media_trimestral_por_mes = ventas_por_mes.resample(&#39;Q&#39;).mean()
</pre></div>
</div>
<img alt="_images/6b0e4ede211ca78046dcaa44a954ee78b04997f7ea972e3994a0fd1cd19e3eca.png" src="_images/6b0e4ede211ca78046dcaa44a954ee78b04997f7ea972e3994a0fd1cd19e3eca.png" />
</div>
</div>
<p>El gráfico muestra que las ventas mensuales (línea azul) son bastante irregulares, con picos destacados hacia finales de 2010 y 2011. Sin embargo, la media trimestral (línea roja) suaviza estas variaciones, indicando una tendencia general de crecimiento, especialmente en el segundo semestre de 2011.</p>
</section>
<section id="analisis-de-componentes">
<h3>3.2 Análisis de componentes<a class="headerlink" href="#analisis-de-componentes" title="Link to this heading">#</a></h3>
<section id="descomposicion-clasica-aditiva">
<h4>Descomposición clásica (aditiva).<a class="headerlink" href="#descomposicion-clasica-aditiva" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.seasonal</span><span class="w"> </span><span class="kn">import</span> <span class="n">seasonal_decompose</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Remuestreo por día para obtener la suma de ventas diarias</span>
<span class="n">ventas_por_dia</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Descomposición aditiva (para patrones de magnitud constante)</span>
<span class="n">descomposicion_aditiva_dia</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">ventas_por_dia</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>


<span class="c1"># Visualización de la descomposición aditiva diaria</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">descomposicion_aditiva_dia</span><span class="o">.</span><span class="n">observed</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Serie Observada (Aditiva)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">descomposicion_aditiva_dia</span><span class="o">.</span><span class="n">trend</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Tendencia&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">descomposicion_aditiva_dia</span><span class="o">.</span><span class="n">seasonal</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Estacionalidad Diaria&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">descomposicion_aditiva_dia</span><span class="o">.</span><span class="n">resid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Residuales (Ruido)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c43c94717b34cbd98294913a5fdf5bc8a71c688269f72b1cba95e00b826af0ab.png" src="_images/c43c94717b34cbd98294913a5fdf5bc8a71c688269f72b1cba95e00b826af0ab.png" />
</div>
</div>
<p>La gráfica muestra la descomposición aditiva de las ventas diarias. La primera sección es la serie original, donde se observan picos irregulares y fluctuaciones en las ventas. La segunda sección muestra la tendencia, con un incremento gradual hacia finales del periodo. La tercera sección representa la estacionalidad diaria, destacando patrones repetitivos que ocurren a lo largo de los días. Finalmente, los residuales indican el ruido o las variaciones no explicadas por la tendencia ni la estacionalidad, donde se observan algunos picos aislados que podrían deberse a eventos inusuales o errores.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa</span><span class="w"> </span><span class="kn">import</span> <span class="n">stattools</span><span class="p">,</span> <span class="n">seasonal</span>

<span class="c1"># Remuestreo por semana para obtener la suma de ventas semanales</span>
<span class="n">ventas_semanales</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Descomposición aditiva (modelo clásico)</span>
<span class="n">decompose_model_aditivo</span> <span class="o">=</span> <span class="n">seasonal</span><span class="o">.</span><span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">ventas_semanales</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Extraer los residuos (variaciones irregulares)</span>
<span class="n">irr_var_aditivo</span> <span class="o">=</span> <span class="n">decompose_model_aditivo</span><span class="o">.</span><span class="n">resid</span>

<span class="c1"># Asegurarse de que no haya valores NaN antes de la prueba ADF</span>
<span class="n">irr_var_limpios</span> <span class="o">=</span> <span class="n">irr_var_aditivo</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">irr_var_aditivo</span><span class="p">)]</span>

<span class="c1"># Aplicar la prueba ADF sobre los residuos de la descomposición aditiva</span>
<span class="n">adf_result_aditivo</span> <span class="o">=</span> <span class="n">stattools</span><span class="o">.</span><span class="n">adfuller</span><span class="p">(</span><span class="n">irr_var_limpios</span><span class="p">,</span> <span class="n">autolag</span><span class="o">=</span><span class="s1">&#39;AIC&#39;</span><span class="p">)</span>

<span class="c1"># Imprimir el p-valor de la prueba ADF</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-valor de la prueba ADF en las variaciones irregulares (residuos) de la descomposición aditiva:&#39;</span><span class="p">,</span> <span class="n">adf_result_aditivo</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Visualización de los componentes de la descomposición aditiva</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

<span class="n">ventas_semanales</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ventas Semanales&#39;</span><span class="p">)</span>

<span class="n">decompose_model_aditivo</span><span class="o">.</span><span class="n">trend</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Componente de Tendencia (Aditiva)&#39;</span><span class="p">)</span>

<span class="n">decompose_model_aditivo</span><span class="o">.</span><span class="n">seasonal</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Componente Estacional (Aditiva)&#39;</span><span class="p">)</span>

<span class="n">decompose_model_aditivo</span><span class="o">.</span><span class="n">resid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Variaciones Irregulares (Residuos Aditivos)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p-valor de la prueba ADF en las variaciones irregulares (residuos) de la descomposición aditiva: 5.4674969170685074e-14
</pre></div>
</div>
<img alt="_images/779f7056690a29f3536f7680cf3a6449105cea80e17895dca456d98abeb1c550.png" src="_images/779f7056690a29f3536f7680cf3a6449105cea80e17895dca456d98abeb1c550.png" />
</div>
</div>
<p>La gráfica muestra la descomposición aditiva de las ventas semanales. La primera parte es la serie original con fluctuaciones notables en ciertos periodos. La tendencia revela un crecimiento constante en las ventas a lo largo del tiempo, mientras que la estacionalidad semanal presenta patrones repetitivos característicos de cada semana. Por último, los residuales representan el ruido o las variaciones que no se explican por la tendencia ni la estacionalidad, donde se observan algunos picos irregulares que podrían deberse a factores externos o eventos inesperados.</p>
<p>En el componente de tendencia se observa un incremento inicial en las ventas seguido de un descenso alrededor de finales de 2010 y principios de 2011, posteriormente, se observa un repunte en las ventas hacia finales del período, este comportamiento sugiere que las ventas tienen ciclos de crecimiento y decrecimiento, posiblemente asociados a factores externos como campañas de marketing, cambios en la demanda estacional o fluctuaciones económicas.</p>
<p>El p-valor extremadamente bajo (5.47e-14) en la prueba ADF aplicada a los residuos indica que estos son altamente estacionarios. Esto confirma que la descomposición ha capturado correctamente la estructura subyacente de la serie temporal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Asegúrate de tener la serie temporal de ventas mensuales</span>
<span class="n">ventas_por_mes</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Descomposición aditiva</span>
<span class="n">descomposicion_aditiva</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">ventas_por_mes</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Visualización de la descomposición aditiva</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">descomposicion_aditiva</span><span class="o">.</span><span class="n">observed</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Serie Observada (Aditiva)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">descomposicion_aditiva</span><span class="o">.</span><span class="n">trend</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Tendencia&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">descomposicion_aditiva</span><span class="o">.</span><span class="n">seasonal</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Estacionalidad&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">descomposicion_aditiva</span><span class="o">.</span><span class="n">resid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Residuales (Ruido)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ronal\AppData\Local\Temp\ipykernel_5780\1374544941.py:2: FutureWarning: &#39;M&#39; is deprecated and will be removed in a future version, please use &#39;ME&#39; instead.
  ventas_por_mes = data3[&#39;Quantity&#39;].resample(&#39;M&#39;).sum()
</pre></div>
</div>
<img alt="_images/fb052104d4efeab821babc7809cfbd723a5168611c7995c1b96c2a91f9f0c632.png" src="_images/fb052104d4efeab821babc7809cfbd723a5168611c7995c1b96c2a91f9f0c632.png" />
</div>
</div>
</section>
<section id="descomposicion-stl">
<h4>Descomposicion STL<a class="headerlink" href="#descomposicion-stl" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa</span><span class="w"> </span><span class="kn">import</span> <span class="n">stattools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.seasonal</span><span class="w"> </span><span class="kn">import</span> <span class="n">STL</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Asegúrate de que &#39;InvoiceDate&#39; esté en formato datetime y sea el índice</span>
<span class="n">data3</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data3</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Suponiendo que la columna &#39;Quantity&#39; representa las ventas por transacción</span>
<span class="c1"># Primero agrupamos por día si los datos están a nivel de transacción para simplificar el análisis</span>
<span class="n">ventas_diarias</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Verificar valores faltantes en la serie diaria</span>
<span class="n">missing</span> <span class="o">=</span> <span class="n">ventas_diarias</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Número de valores faltantes encontrados:&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="c1"># Eliminar valores faltantes si existen</span>
<span class="n">ventas_diarias</span> <span class="o">=</span> <span class="n">ventas_diarias</span><span class="p">[</span><span class="o">~</span><span class="n">missing</span><span class="p">]</span>

<span class="c1"># Prueba ADF para verificar estacionariedad en la serie original (diaria)</span>
<span class="n">adf_result</span> <span class="o">=</span> <span class="n">stattools</span><span class="o">.</span><span class="n">adfuller</span><span class="p">(</span><span class="n">ventas_diarias</span><span class="p">,</span> <span class="n">autolag</span><span class="o">=</span><span class="s1">&#39;AIC&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-valor de la prueba ADF en las variaciones diarias:&#39;</span><span class="p">,</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Descomposición STL en la serie diaria (asumiendo estacionalidad semanal -&gt; period=7)</span>
<span class="n">stl_model</span> <span class="o">=</span> <span class="n">STL</span><span class="p">(</span><span class="n">ventas_diarias</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Estacionalidad semanal en datos diarios</span>
<span class="n">descomposicion_stl</span> <span class="o">=</span> <span class="n">stl_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Visualización de los componentes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

<span class="c1"># Serie original de ventas diarias</span>
<span class="n">ventas_diarias</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ventas Diarias&#39;</span><span class="p">)</span>

<span class="c1"># Componente de tendencia</span>
<span class="n">descomposicion_stl</span><span class="o">.</span><span class="n">trend</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Componente de Tendencia en Ventas Diarias&#39;</span><span class="p">)</span>

<span class="c1"># Componente estacional</span>
<span class="n">descomposicion_stl</span><span class="o">.</span><span class="n">seasonal</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Componente Estacional Diario&#39;</span><span class="p">)</span>

<span class="c1"># Variaciones irregulares (residuos)</span>
<span class="n">descomposicion_stl</span><span class="o">.</span><span class="n">resid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Variaciones Irregulares en Ventas Diarias&#39;</span><span class="p">)</span>

<span class="c1"># Ajustes de visualización</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Número de valores faltantes encontrados: 0
p-valor de la prueba ADF en las variaciones diarias: 0.05337431974420152
</pre></div>
</div>
<img alt="_images/d577e60d9cab0d2dd4dad89b8f727078363a4431adca1f3820943c3ae967c7d7.png" src="_images/d577e60d9cab0d2dd4dad89b8f727078363a4431adca1f3820943c3ae967c7d7.png" />
</div>
</div>
<p>La descomposición STL de las ventas diarias muestra que la tendencia ha tenido altibajos, con una ligera caída al inicio y un aumento hacia el final. El componente estacional refleja un patrón semanal bien definido, donde algunos días de la semana las ventas suben y otros bajan de forma constante. Las variaciones irregulares son los picos y caídas inesperadas que no se explican por la tendencia ni la estacionalidad.</p>
<p>El p-valor de la prueba ADF (0.053) en las variaciones diarias está justo en el límite típico de 0.05, lo que sugiere que las series no son completamente estacionarias, pero están cerca. Esto significa que podría haber cierta dependencia en el tiempo, aunque no es muy fuerte.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Suponiendo que data3 ya está cargado y la columna &#39;InvoiceDate&#39; es el índice</span>
<span class="c1"># Asegúrate de que &#39;InvoiceDate&#39; esté en formato datetime y sea el índice</span>
<span class="n">data3</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data3</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Remuestreo por semana para obtener la suma de ventas semanales</span>
<span class="n">ventas_semanales</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Verificar valores faltantes</span>
<span class="n">missing</span> <span class="o">=</span> <span class="n">ventas_semanales</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Número de valores faltantes encontrados:&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="c1"># Eliminar valores faltantes si existen</span>
<span class="n">ventas_semanales</span> <span class="o">=</span> <span class="n">ventas_semanales</span><span class="p">[</span><span class="o">~</span><span class="n">missing</span><span class="p">]</span>

<span class="c1"># Prueba ADF para verificar estacionariedad</span>
<span class="n">adf_result</span> <span class="o">=</span> <span class="n">stattools</span><span class="o">.</span><span class="n">adfuller</span><span class="p">(</span><span class="n">ventas_semanales</span><span class="p">,</span> <span class="n">autolag</span><span class="o">=</span><span class="s1">&#39;AIC&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-valor de la prueba ADF en las variaciones semanales:&#39;</span><span class="p">,</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Descomposición STL semanal (suponiendo estacionalidad mensual en semanas -&gt; period=4)</span>
<span class="n">stl_model</span> <span class="o">=</span> <span class="n">STL</span><span class="p">(</span><span class="n">ventas_semanales</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">descomposicion_stl</span> <span class="o">=</span> <span class="n">stl_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Visualización de los componentes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

<span class="c1"># Serie original de ventas semanales</span>
<span class="n">ventas_semanales</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ventas Semanales&#39;</span><span class="p">)</span>

<span class="c1"># Componente de tendencia</span>
<span class="n">descomposicion_stl</span><span class="o">.</span><span class="n">trend</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Componente de Tendencia en Ventas Semanales&#39;</span><span class="p">)</span>

<span class="c1"># Componente estacional</span>
<span class="n">descomposicion_stl</span><span class="o">.</span><span class="n">seasonal</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Componente Estacional en Ventas Semanales&#39;</span><span class="p">)</span>

<span class="c1"># Variaciones irregulares (residuos)</span>
<span class="n">descomposicion_stl</span><span class="o">.</span><span class="n">resid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Variaciones Irregulares en Ventas Semanales&#39;</span><span class="p">)</span>

<span class="c1"># Ajustes de visualización</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Número de valores faltantes encontrados: 0
p-valor de la prueba ADF en las variaciones semanales: 0.2577096513908132
</pre></div>
</div>
<img alt="_images/d6b66b5d03ceb3690c1e3cc281307f417fec2f7b61a49801c36780a5ef58ffd9.png" src="_images/d6b66b5d03ceb3690c1e3cc281307f417fec2f7b61a49801c36780a5ef58ffd9.png" />
</div>
</div>
<p>La descomposición STL de las ventas semanales muestra tres cosas importantes. La tendencia indica que las ventas bajaron al principio, pero luego empezaron a subir de forma constante. La estacionalidad muestra un patrón que se repite cada semana, lo que sugiere que hay ciertos días o semanas donde las ventas siempre suben o bajan. Finalmente, los residuales son las variaciones que no se explican ni por la tendencia ni por la estacionalidad, como picos inesperados o caídas raras en las ventas. sin embargo,</p>
<p>El p-valor de la prueba ADF (0.2577) en las variaciones semanales sugiere que las series no son completamente estacionarias.</p>
</section>
</section>
<section id="deteccion-de-anomalias">
<h3>Detección de anomalías<a class="headerlink" href="#deteccion-de-anomalias" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data3</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Quantity&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="c1"># Organiza el dataframe de mayor a menor de la variable Quantity</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                    Invoice StockCode  Quantity  Price         Country
InvoiceDate                                                           
2011-12-09 09:15:00  581483     23843     80995   2.08  United Kingdom
2011-01-18 10:01:00  541431     23166     74215   1.04  United Kingdom
2010-02-15 11:57:00  497946     37410     19152   0.10         Denmark
2010-03-17 13:09:00  501534     21099     12960   0.10         Denmark
2010-03-17 13:09:00  501534     21091     12960   0.10         Denmark
2010-03-17 13:09:00  501534     21085     12744   0.10         Denmark
2011-11-25 15:57:00  578841     84826     12540   0.00  United Kingdom
2010-03-17 13:09:00  501534     21092     12480   0.10         Denmark
2010-05-10 14:55:00  507637     84016     10200   0.00  United Kingdom
2010-03-23 15:36:00  502269     21984     10000   0.25  United Kingdom
</pre></div>
</div>
</div>
</div>
<p>Los valores 80995 y 74125 son extremadamente altos, estas observaciones parecen ser outliers, por tanto, procederemos a liminar todos los outliers del dataframe. para determinar el método de eliminación primero debemos realizar una prueba de normalidad para muestras grandes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">kstest</span><span class="p">,</span> <span class="n">norm</span>

<span class="n">media</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">desviacion</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="n">estadistico</span><span class="p">,</span> <span class="n">p_valor</span> <span class="o">=</span> <span class="n">kstest</span><span class="p">(</span><span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">],</span> <span class="s1">&#39;norm&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">media</span><span class="p">,</span> <span class="n">desviacion</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estadístico de Kolmogorov-Smirnov: </span><span class="si">{</span><span class="n">estadistico</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-valor: </span><span class="si">{</span><span class="n">p_valor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">p_valor</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No se rechaza la hipótesis nula: los datos siguen una distribución normal.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Se rechaza la hipótesis nula: los datos no siguen una distribución normal.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estadístico de Kolmogorov-Smirnov: 0.4686654971117322
P-valor: 0.0
Se rechaza la hipótesis nula: los datos no siguen una distribución normal.
</pre></div>
</div>
</div>
</div>
<p>Con un p-valor de 0.4686 se rechaza la hipotesis nula. Como los datos no siguen una distribución normal, el método apropiado para la eliminación de outliers es utilizando el rango intercuartílico.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q1</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">Q3</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>

<span class="n">limite_inferior</span> <span class="o">=</span> <span class="n">Q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span>
<span class="n">limite_superior</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span> <span class="c1"># definimos los límites para los valores normales</span>


<span class="c1"># Filtrar los datos dentro del rango aceptable</span>
<span class="n">data4</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[(</span><span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">limite_inferior</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data3</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">limite_superior</span><span class="p">)]</span> <span class="c1"># realiza un filtro de los datos dentro del rango aceptable</span>


<span class="nb">print</span><span class="p">(</span><span class="n">data4</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span> <span class="c1"># verifica los nuevos valores mínimos y máximos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    956871.000000
mean          5.879415
std           6.280991
min           1.000000
25%           1.000000
50%           3.000000
75%          10.000000
max          28.000000
Name: Quantity, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Al eliminar los outliers los estadisticos descriptivos de Quantity (Cantidad), son mas razonables, el promedio de compras es de 5.87 y la desviacion estandar es de 6.2 (mucho mas pequeño que el SD obtenido antes de hacer la limpieza), la dispercion se redujo mucho, por tanto, los datos son mas estables. Ademas, el rango de ventas esta entre 1 y 28.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data4</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">],</span> <span class="n">vert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Boxplot sin outliers&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Cantidad de compras&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e8b6cc28ea6dcce673da78f5fa95de6db5db32e8cb745d60ade3a36cb155775f.png" src="_images/e8b6cc28ea6dcce673da78f5fa95de6db5db32e8cb745d60ade3a36cb155775f.png" />
</div>
</div>
<p>Aunque la distribución de la cantidad de compras parece mucho más compacta, todavía hay algunos valores fuera del límite superior, sin embargo, estos son mucho más moderados.</p>
</section>
</section>
<section id="estacionalidad-y-periodicidad">
<h2>4 Estacionalidad y periodicidad<a class="headerlink" href="#estacionalidad-y-periodicidad" title="Link to this heading">#</a></h2>
<section id="analisis-de-patrones-recurrentes">
<h3>4.1. Análisis de patrones recurrentes<a class="headerlink" href="#analisis-de-patrones-recurrentes" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Graficar la función de autocorrelación</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">ventas_diarias</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">52</span><span class="p">)</span>  <span class="c1"># </span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Gráfico de Autocorrelación (ACF)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1000x500 with 0 Axes&gt;
</pre></div>
</div>
<img alt="_images/b30a876f0519035d5ca11a1a11964cc01ed66d8c402dfff7eaa36abea0ee9f66.png" src="_images/b30a876f0519035d5ca11a1a11964cc01ed66d8c402dfff7eaa36abea0ee9f66.png" />
</div>
</div>
<p>El gráfico muestra poca autocorrelación después del primer punto, lo que indica que las ventas no están fuertemente relacionadas entre sí en el tiempo. Esto sugiere que es más difícil encontrar patrones claros para predecir futuras ventas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Graficar la función de autocorrelación</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">ventas_semanales</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">52</span><span class="p">)</span>  <span class="c1"># 52 semanas para ver patrones anuales</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Gráfico de Autocorrelación (ACF)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1000x500 with 0 Axes&gt;
</pre></div>
</div>
<img alt="_images/357602743a62036a0aeda67266d7467e7c58d5de65b4be4c45b0b3f0250fdfe2.png" src="_images/357602743a62036a0aeda67266d7467e7c58d5de65b4be4c45b0b3f0250fdfe2.png" />
</div>
</div>
<p>El gráfico muestra que hay autocorrelación en los primeros días, es decir, las ventas recientes están relacionadas entre sí. Esto es bueno para predecir porque indica que hay patrones en los datos. A medida que pasa el tiempo, esa relación se pierde y las ventas se vuelven más aleatorias.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Graficar la función de autocorrelación parcial</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plot_pacf</span><span class="p">(</span><span class="n">ventas_diarias</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">52</span><span class="p">)</span>  <span class="c1"># Diarias</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Gráfico de Autocorrelación Parcial (PACF)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1000x500 with 0 Axes&gt;
</pre></div>
</div>
<img alt="_images/89f85d5f655cc4fd9a56c7a5e2b48c858c73eabebdaeed12cd97088595d3ea58.png" src="_images/89f85d5f655cc4fd9a56c7a5e2b48c858c73eabebdaeed12cd97088595d3ea58.png" />
</div>
</div>
<p>Este gráfico PACF (Autocorrelación Parcial) muestra la relación de las ventas diarias con sus propios rezagos, es decir, cómo influye cada día en los días siguientes después de eliminar el efecto de los días intermedios. Aquí, el primer rezago (lag 1) tiene una autocorrelación muy fuerte, lo que es normal, ya que un día suele parecerse mucho al anterior. Sin embargo, la mayoría de los otros rezagos están dentro del área sombreada (que representa el intervalo de confianza), lo que indica que no hay relaciones significativas con días más alejados. Esto sugiere que, más allá del día anterior, las ventas no tienen una fuerte dependencia de días previos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Graficar la función de autocorrelación parcial</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plot_pacf</span><span class="p">(</span><span class="n">ventas_semanales</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">52</span><span class="p">)</span>  <span class="c1"># Mismo horizonte de 52 semanas</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Gráfico de Autocorrelación Parcial (PACF)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1000x500 with 0 Axes&gt;
</pre></div>
</div>
<img alt="_images/403037d16d3bd1db0ef58ee012db7a26b732396f976b9e8677eee7a58c93efe2.png" src="_images/403037d16d3bd1db0ef58ee012db7a26b732396f976b9e8677eee7a58c93efe2.png" />
</div>
</div>
<p>Este gráfico PACF para las ventas semanales muestra que el primer rezago (la semana anterior) tiene una autocorrelación parcial fuerte, lo cual es normal porque las ventas de una semana suelen verse influenciadas por la semana previa. También hay un pico significativo en el segundo rezago, lo que indica que las ventas de dos semanas atrás todavía tienen cierto impacto. Después de eso, la mayoría de los puntos están dentro del área sombreada, lo que sugiere que no hay una dependencia fuerte con semanas más alejadas.</p>
<p>En el gráfico PACF de las ventas semanales, se observan algunos patrones interesantes. El primer rezago muestra una autocorrelación fuerte, lo que significa que las ventas de una semana están influenciadas por la semana anterior. El segundo rezago también destaca, indicando que las ventas de hace dos semanas todavía tienen cierto efecto. Sin embargo, no se observan picos repetidos en intervalos regulares que sugieran una estacionalidad clara, como ciclos mensuales o trimestrales. Esto indica que las dependencias temporales más importantes son a corto plazo (una o dos semanas), y no hay un patrón estacional evidente en los datos semanales.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data4</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data4</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Agregar una columna de mes</span>
<span class="n">data4</span><span class="p">[</span><span class="s2">&quot;mes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data4</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span>

<span class="c1"># Crear el boxplot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;mes&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Quantity&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data4</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribución de Compras por Mes&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Mes del Año&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cantidad de Compras&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ronal\AppData\Local\Temp\ipykernel_5780\106326190.py:4: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data4[&quot;mes&quot;] = data4.index.month
</pre></div>
</div>
<img alt="_images/32ef3427d6297c74694cb14083cd323cb6b474e07da0cbe9da505c11c82bf3ce.png" src="_images/32ef3427d6297c74694cb14083cd323cb6b474e07da0cbe9da505c11c82bf3ce.png" />
</div>
</div>
<p>La mayoría de los meses presentan una cantidad de compras bastante similar, pero se destacan algunos meses como septiembre (mes 9), donde la mediana es más alta y el rango intercuartílico es más amplio, lo que indica mayor variabilidad en las compras. Además, hay una gran cantidad de valores atípicos (puntos por encima de los bigotes) en todos los meses, sugiriendo que, aunque la mayoría de los días tienen pocas compras, hay días específicos con picos inusuales. Esto podría estar relacionado con promociones o eventos especiales.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data4</span><span class="p">[</span><span class="s2">&quot;dia_semana&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data4</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofweek</span>  <span class="c1"># 0 = Lunes, 6 = Domingo</span>

<span class="c1"># Crear el boxplot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;dia_semana&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Quantity&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data4</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Purples&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribución de Compras por Día de la Semana&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Día de la Semana (0=Lunes, 6=Domingo)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cantidad de Compras&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ronal\AppData\Local\Temp\ipykernel_5780\2540970866.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data4[&quot;dia_semana&quot;] = data4.index.dayofweek  # 0 = Lunes, 6 = Domingo
</pre></div>
</div>
<img alt="_images/26f3b3ae521fc61f2f120be80ed29f4c63e70c3f504ea4e0a92236d0dd62bd56.png" src="_images/26f3b3ae521fc61f2f120be80ed29f4c63e70c3f504ea4e0a92236d0dd62bd56.png" />
</div>
</div>
<p>El diagrama de caja muestra cómo varían las compras a lo largo de la semana. El sábado (día 5) es el día con mayor cantidad de compras, reflejado en una mediana más alta y un rango intercuartílico más amplio, lo que indica más variabilidad. En contraste, el domingo (día 6) muestra la menor cantidad de compras, con una mediana baja y menos dispersión. Los demás días de la semana presentan distribuciones similares, aunque con ligeras diferencias en la cantidad de compras. Además, en todos los días se observan valores atípicos, lo que sugiere que hay días con picos de ventas inusuales.</p>
</section>
</section>
<section id="analisis-de-tendencia">
<h2>5 Análisis de tendencia<a class="headerlink" href="#analisis-de-tendencia" title="Link to this heading">#</a></h2>
<section id="agrupados-por-dias">
<h3>Agrupados por dias<a class="headerlink" href="#agrupados-por-dias" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data4</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data4</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Agrupar las ventas por día</span>
<span class="n">ventas_diarias</span> <span class="o">=</span> <span class="n">data4</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Visualizar las ventas diarias</span>
<span class="n">ventas_diarias</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Ventas Diarias Originales&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: title={&#39;center&#39;: &#39;Ventas Diarias Originales&#39;}, xlabel=&#39;InvoiceDate&#39;&gt;
</pre></div>
</div>
<img alt="_images/4fd7ff52e4f837228b904a8cdc3c035c6522ba89cb632cec4475f8315ce53e36.png" src="_images/4fd7ff52e4f837228b904a8cdc3c035c6522ba89cb632cec4475f8315ce53e36.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.holtwinters</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimpleExpSmoothing</span>

<span class="c1"># Aplicar suavizamiento exponencial simple con un factor de suavizado (alpha)</span>
<span class="n">ses_model</span> <span class="o">=</span> <span class="n">SimpleExpSmoothing</span><span class="p">(</span><span class="n">ventas_diarias</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">optimized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">suavizado_exponencial</span> <span class="o">=</span> <span class="n">ses_model</span><span class="o">.</span><span class="n">fittedvalues</span>

<span class="c1"># Visualización</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ventas_diarias</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ventas Diarias&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">suavizado_exponencial</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Suavizamiento Exponencial (α=0.2)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Suavizamiento Exponencial en Ventas Diarias&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cantidad Vendida&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4435f28148d4f6b749a6709d5e931027d792c6884625acec26700ebb574e2be4.png" src="_images/4435f28148d4f6b749a6709d5e931027d792c6884625acec26700ebb574e2be4.png" />
</div>
</div>
<p>En este gráfico de ventas diarias, la línea azul muestra la variabilidad diaria en las ventas, mientras que la línea roja refleja el suavizamiento exponencial con un factor de 0.2, ayudando a visualizar la tendencia general. Se nota que, pese a las fluctuaciones diarias, las ventas muestran un crecimiento sostenido hacia finales del periodo analizado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcular la media móvil con una ventana de 7 días (una semana)</span>
<span class="n">media_movil_7d</span> <span class="o">=</span> <span class="n">ventas_diarias</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Visualización</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ventas_diarias</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ventas Diarias&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">media_movil_7d</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Media Móvil (7 días)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Media Móvil en Ventas Diarias (7 días)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cantidad Vendida&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cfe41afc5a8abecde087c1882e24b85a344e3bed2bb73b33e2128e88fcc0395d.png" src="_images/cfe41afc5a8abecde087c1882e24b85a344e3bed2bb73b33e2128e88fcc0395d.png" />
</div>
</div>
<p>En este gráfico, las ventas diarias están representadas en azul, mientras que la línea roja muestra la media móvil de 7 días, que suaviza las fluctuaciones diarias para destacar mejor la tendencia general. A pesar de las variaciones, se observa un aumento progresivo en las ventas hacia el final del periodo, lo que indica una tendencia positiva sostenida.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="c1"># Preparar los datos para la regresión</span>
<span class="n">ventas_diarias_df</span> <span class="o">=</span> <span class="n">ventas_diarias</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">ventas_diarias_df</span><span class="p">[</span><span class="s1">&#39;time_index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ventas_diarias_df</span><span class="p">))</span>  <span class="c1"># Índice temporal</span>

<span class="c1"># Definir variables para la regresión</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">ventas_diarias_df</span><span class="p">[[</span><span class="s1">&#39;time_index&#39;</span><span class="p">]]</span>  <span class="c1"># Variable independiente (tiempo)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ventas_diarias_df</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span>      <span class="c1"># Variable dependiente (ventas)</span>

<span class="c1"># Ajuste del modelo de regresión lineal</span>
<span class="n">modelo_lineal</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">modelo_lineal</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">tendencia_lineal</span> <span class="o">=</span> <span class="n">modelo_lineal</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Visualización</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ventas_diarias_df</span><span class="p">[</span><span class="s1">&#39;InvoiceDate&#39;</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ventas Diarias&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ventas_diarias_df</span><span class="p">[</span><span class="s1">&#39;InvoiceDate&#39;</span><span class="p">],</span> <span class="n">tendencia_lineal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Tendencia Lineal&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Tendencia Lineal en Ventas Diarias&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cantidad Vendida&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/10ff192223373153f86ef5bbcb001d612e00bfddf6d78d6167c9220c641e1be6.png" src="_images/10ff192223373153f86ef5bbcb001d612e00bfddf6d78d6167c9220c641e1be6.png" />
</div>
</div>
<p>En este gráfico, la línea azul muestra las ventas diarias, mientras que la línea roja representa la tendencia lineal ajustada. A pesar de las fluctuaciones diarias, la tendencia general es ascendente, indicando un crecimiento en las ventas a lo largo del tiempo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.stattools</span><span class="w"> </span><span class="kn">import</span> <span class="n">adfuller</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">data4</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data4</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Usar la serie original directamente (sin agrupar por día)</span>
<span class="n">ventas_originales</span> <span class="o">=</span> <span class="n">data4</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="c1"># Tomar una muestra de los últimos 100,000 registros para reducir el uso de memoria</span>
<span class="n">ventas_muestra</span> <span class="o">=</span> <span class="n">ventas_originales</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">500000</span><span class="p">)</span>

<span class="c1"># Aplicar la prueba ADF en la muestra</span>
<span class="n">resultado_adf_muestra</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">ventas_muestra</span><span class="p">,</span> <span class="n">autolag</span><span class="o">=</span><span class="s1">&#39;AIC&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--- Resultado con Muestra Reducida ---&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Estadístico de Prueba ADF:&#39;</span><span class="p">,</span> <span class="n">resultado_adf_muestra</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-valor:&#39;</span><span class="p">,</span> <span class="n">resultado_adf_muestra</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Resultado con Muestra Reducida ---
Estadístico de Prueba ADF: -51.40231174240281
p-valor: 0.0
</pre></div>
</div>
</div>
</div>
<p>Con un p-valor &lt;0.05, rechazamos Ho, esto indica que la serie no tiene raíz unitaria y, por lo tanto, es estacionaria.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.stattools</span><span class="w"> </span><span class="kn">import</span> <span class="n">kpss</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>


<span class="c1"># Aplicar la prueba KPSS directamente sobre la serie original completa</span>
<span class="n">resultado_kpss</span> <span class="o">=</span> <span class="n">kpss</span><span class="p">(</span><span class="n">ventas_originales</span><span class="p">,</span> <span class="n">regression</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>

<span class="c1"># Extraer los resultados</span>
<span class="n">estadistico_kpss</span> <span class="o">=</span> <span class="n">resultado_kpss</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">p_valor_kpss</span> <span class="o">=</span> <span class="n">resultado_kpss</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">valores_criticos</span> <span class="o">=</span> <span class="n">resultado_kpss</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

<span class="c1"># Imprimir los resultados</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--- Resultado KPSS en la Serie Original Completa ---&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Estadístico KPSS:&#39;</span><span class="p">,</span> <span class="n">estadistico_kpss</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-valor:&#39;</span><span class="p">,</span> <span class="n">p_valor_kpss</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Valores Críticos:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">clave</span><span class="p">,</span> <span class="n">valor</span> <span class="ow">in</span> <span class="n">valores_criticos</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;   </span><span class="si">{</span><span class="n">clave</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">valor</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Resultado KPSS en la Serie Original Completa ---
Estadístico KPSS: 0.9916418827063542
p-valor: 0.01
Valores Críticos:
   10%: 0.347
   5%: 0.463
   2.5%: 0.574
   1%: 0.739
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ronal\AppData\Local\Temp\ipykernel_5780\1849100653.py:7: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is smaller than the p-value returned.

  resultado_kpss = kpss(ventas_originales, regression=&#39;c&#39;, nlags=&quot;auto&quot;)
</pre></div>
</div>
</div>
</div>
<p>En la prueba de KPSS se obtuvo un p-valor &lt;0.05, por tanto se rechaza Ho, sin embargo, a diferencia de la prueba ADF, donde la hipótesis nula (H₀) es que la serie NO es estacionaria, en KPSS la H₀ indica que la serie es estacionaria, por ende, segun los resultados de la prueba KPSS la serie NO es estacionaria, esto contradice los resultados de la prueba de Dickey-Fuller</p>
</section>
<section id="agrupando-por-ventas-diarias">
<h3>Agrupando por ventas diarias<a class="headerlink" href="#agrupando-por-ventas-diarias" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aplicar la prueba KPSS en la serie agrupada por día</span>
<span class="n">resultado_kpss_dia</span> <span class="o">=</span> <span class="n">kpss</span><span class="p">(</span><span class="n">ventas_diarias</span><span class="p">,</span> <span class="n">regression</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>

<span class="c1"># Extraer los resultados</span>
<span class="n">estadistico_kpss</span> <span class="o">=</span> <span class="n">resultado_kpss_dia</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">p_valor_kpss</span> <span class="o">=</span> <span class="n">resultado_kpss_dia</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">valores_criticos</span> <span class="o">=</span> <span class="n">resultado_kpss_dia</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

<span class="c1"># Imprimir los resultados</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--- Resultado KPSS en Ventas Diarias ---&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Estadístico KPSS:&#39;</span><span class="p">,</span> <span class="n">estadistico_kpss</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-valor:&#39;</span><span class="p">,</span> <span class="n">p_valor_kpss</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Valores Críticos:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">clave</span><span class="p">,</span> <span class="n">valor</span> <span class="ow">in</span> <span class="n">valores_criticos</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;   </span><span class="si">{</span><span class="n">clave</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">valor</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Resultado KPSS en Ventas Diarias ---
Estadístico KPSS: 1.0209266506989978
p-valor: 0.01
Valores Críticos:
   10%: 0.347
   5%: 0.463
   2.5%: 0.574
   1%: 0.739
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ronal\AppData\Local\Temp\ipykernel_5780\791655191.py:2: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is smaller than the p-value returned.

  resultado_kpss_dia = kpss(ventas_diarias, regression=&#39;c&#39;, nlags=&quot;auto&quot;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aplicar la prueba de Dickey-Fuller Aumentada (ADF)</span>
<span class="n">resultado_adf</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">ventas_diarias</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">autolag</span><span class="o">=</span><span class="s1">&#39;AIC&#39;</span><span class="p">)</span>

<span class="c1"># Extraer el p-valor y el estadístico de prueba</span>
<span class="n">estadistico_adf</span> <span class="o">=</span> <span class="n">resultado_adf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">p_valor_adf</span> <span class="o">=</span> <span class="n">resultado_adf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">valores_criticos</span> <span class="o">=</span> <span class="n">resultado_adf</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

<span class="c1"># Imprimir los resultados</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Estadístico de Prueba ADF:&#39;</span><span class="p">,</span> <span class="n">estadistico_adf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-valor:&#39;</span><span class="p">,</span> <span class="n">p_valor_adf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Valores Críticos:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">clave</span><span class="p">,</span> <span class="n">valor</span> <span class="ow">in</span> <span class="n">valores_criticos</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;   </span><span class="si">{</span><span class="n">clave</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">valor</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estadístico de Prueba ADF: -2.077379015563608
p-valor: 0.2537073468783196
Valores Críticos:
   1%: -3.439490435810785
   5%: -2.8655738086413374
   10%: -2.568918067209286
</pre></div>
</div>
</div>
</div>
<p>Al agrupar por ventas diarias, tanto la prueba ADF como KPSS indican que no hay estacionaridad</p>
</section>
<section id="visualizacion-de-la-media-y-varianza-en-submuestras-evaluar-si-cambian-con-el-tiempo">
<h3>Visualización de la media y varianza en submuestras: Evaluar si cambian con el tiempo.<a class="headerlink" href="#visualizacion-de-la-media-y-varianza-en-submuestras-evaluar-si-cambian-con-el-tiempo" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definir el número de submuestras</span>
<span class="n">num_submuestras</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Asegurar que sean 20 submuestras</span>

<span class="c1"># Dividir la serie en partes iguales</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data4</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">])</span>
<span class="n">tamaño_submuestra</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="n">num_submuestras</span>

<span class="n">medias</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">varianzas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rangos</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_submuestras</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># Números del 1 al 20 como etiquetas</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_submuestras</span><span class="p">):</span>
    <span class="n">inicio</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">tamaño_submuestra</span>
    <span class="n">fin</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">tamaño_submuestra</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">num_submuestras</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">n</span>
    <span class="n">submuestra</span> <span class="o">=</span> <span class="n">data4</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">inicio</span><span class="p">:</span><span class="n">fin</span><span class="p">]</span>
    
    <span class="n">medias</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">submuestra</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">varianzas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">submuestra</span><span class="o">.</span><span class="n">var</span><span class="p">())</span>

<span class="c1"># Visualización de la media y varianza en submuestras</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Gráfica de la media</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Submuestras&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Media&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rangos</span><span class="p">,</span> <span class="n">medias</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Media&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">)</span>

<span class="c1"># Crear un segundo eje para la varianza</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Varianza&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:red&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rangos</span><span class="p">,</span> <span class="n">varianzas</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Varianza&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;tab:red&quot;</span><span class="p">)</span>

<span class="c1"># Ajustar etiquetas del eje x para evitar que se amontonen</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rangos</span><span class="p">,</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;S</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rangos</span><span class="p">])</span>  <span class="c1"># Etiquetas cortas como S1, S2, ..., S20</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Evolución de la Media y la Varianza en Submuestras&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ed6f009aab239db3d6155d6e53c9b1f78b2a2bcf232793f4bbeb8aac2fa52a4f.png" src="_images/ed6f009aab239db3d6155d6e53c9b1f78b2a2bcf232793f4bbeb8aac2fa52a4f.png" />
</div>
</div>
<p>Siendo la muestra la linea azul, se puede observar que esta presenta cambios significativos entre las submuestras, sin embargo, los aumentos y caídas bruscas en varias secciones indican que la serie puede tener tendencia o estacionalida, como podemos ver en la submuestra 8, con un pico elevado, seguido de una brusca caida, esto tambien se puede observar en la submuestra 17 con un pico elevado, seguido de una caida. Por otro lado, cuando una serie es estacionaria se espera que la media permanezca inestable, lo cual no sucede en este caso.
Por otro lado, la varianza (linea roja), sigue una tendencia muy similar a la de la media, con subidas y bajadas en los mismo puntos que la media. Al igual que la media, como la varianza no es constante a lo largo de las submuestras también sugiere falta de estacionariedad.
Para lograr que la serie sea estacionaria, se debe aplicar una transformacion</p>
</section>
<section id="transformaciones-de-datos">
<h3>6.2. Transformaciones de datos<a class="headerlink" href="#transformaciones-de-datos" title="Link to this heading">#</a></h3>
<p>A continuación realizaremos una agrupación por días y a esta agrupación le aplicaremos la diferenciación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ventas_diarias</span> <span class="o">=</span> <span class="n">data4</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># -----------------------------------------</span>
<span class="c1"># Aplicar Diferenciación para Eliminar la Tendencia</span>
<span class="c1"># -----------------------------------------</span>

<span class="c1"># Diferenciación de la serie temporal</span>
<span class="n">ventas_diferenciadas</span> <span class="o">=</span> <span class="n">ventas_diarias</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Guardar los datos diferenciados en un nuevo DataFrame llamado data5</span>
<span class="n">data5</span> <span class="o">=</span> <span class="n">ventas_diferenciadas</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Ventas_Diferenciadas&#39;</span><span class="p">)</span>

<span class="c1"># -----------------------------------------</span>
<span class="c1"># Verificar Estacionariedad Después de la Diferenciación</span>
<span class="c1"># -----------------------------------------</span>

<span class="c1"># Prueba ADF en la serie diferenciada</span>
<span class="n">adf_result_dif</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">ventas_diferenciadas</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--- Prueba ADF en la Serie Diferenciada ---&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Estadístico ADF:&#39;</span><span class="p">,</span> <span class="n">adf_result_dif</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-valor:&#39;</span><span class="p">,</span> <span class="n">adf_result_dif</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Prueba KPSS en la serie diferenciada</span>
<span class="n">kpss_result_dif</span> <span class="o">=</span> <span class="n">kpss</span><span class="p">(</span><span class="n">ventas_diferenciadas</span><span class="p">,</span> <span class="n">regression</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--- Prueba KPSS en la Serie Diferenciada ---&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Estadístico KPSS:&#39;</span><span class="p">,</span> <span class="n">kpss_result_dif</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-valor:&#39;</span><span class="p">,</span> <span class="n">kpss_result_dif</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># -----------------------------------------</span>
<span class="c1"># Mostrar las Primeras Filas de los Datos Transformados</span>
<span class="c1"># -----------------------------------------</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--- Primeras Filas de data5 (Ventas Diferenciadas) ---&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data5</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Prueba ADF en la Serie Diferenciada ---
Estadístico ADF: -9.244017451569945
p-valor: 1.5548841450233142e-15

--- Prueba KPSS en la Serie Diferenciada ---
Estadístico KPSS: 0.27052803378825135
p-valor: 0.1

--- Primeras Filas de data5 (Ventas Diferenciadas) ---
             Ventas_Diferenciadas
InvoiceDate                      
2009-12-02                -1580.0
2009-12-03                 3254.0
2009-12-04                -3824.0
2009-12-05                -9684.0
2009-12-06                 5563.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ronal\AppData\Local\Temp\ipykernel_5780\1015784044.py:24: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpss_result_dif = kpss(ventas_diferenciadas, regression=&#39;c&#39;, nlags=&quot;auto&quot;)
</pre></div>
</div>
</div>
</div>
<p>Ambas pruebas de estacionariedad, ADF y KPSS, confirman que la serie diferenciada es estacionaria. La prueba ADF muestra un estadístico de -9.235 con un p-valor extremadamente bajo (1.639e-15), lo que indica que rechazamos la hipótesis nula de no estacionariedad. Por su parte, la prueba KPSS arroja un estadístico de 0.315 y un p-valor de 0.1, superior al umbral de 0.05, lo que sugiere que no rechazamos la hipótesis nula de estacionariedad.</p>
</section>
<section id="analisis-multivariado">
<h3>7. Análisis multivariado<a class="headerlink" href="#analisis-multivariado" title="Link to this heading">#</a></h3>
<p>El análisis multivariado no es necesario en nuestro caso, ya que nos estamos enfocando únicamente en la serie de ventas diarias y no contamos con variables adicionales que puedan influir en su comportamiento, como precios, promociones u otros factores externos.</p>
</section>
<section id="identificacion-de-ciclos-y-frecuencias">
<h3>8. Identificación de ciclos y frecuencias<a class="headerlink" href="#identificacion-de-ciclos-y-frecuencias" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aplicar la Transformada de Fourier a la serie de ventas diarias diferenciadas</span>
<span class="n">fft_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">data5</span><span class="p">[</span><span class="s1">&#39;Ventas_Diferenciadas&#39;</span><span class="p">])</span>
<span class="n">frecuencias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fft_result</span><span class="p">),</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># d=1 asume frecuencia diaria</span>

<span class="c1"># Calcular el espectro de magnitudes (módulo de los números complejos)</span>
<span class="n">magnitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft_result</span><span class="p">)</span>

<span class="c1"># Visualizar el espectro de frecuencias</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">frecuencias</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">frecuencias</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">magnitudes</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">magnitudes</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Transformada de Fourier - Espectro de Frecuencias&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia (Ciclos por Día)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitud&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/28fc097cb6426b3bd18b7e59640d1c5b23b7c0961019b114ab208ab4fe3562e1.png" src="_images/28fc097cb6426b3bd18b7e59640d1c5b23b7c0961019b114ab208ab4fe3562e1.png" />
</div>
</div>
<p>La gráfica del espectro de frecuencias muestra varios picos significativos que indican la presencia de ciclos dominantes en las ventas diarias diferenciadas. El pico más alto se encuentra cerca de una frecuencia de 0.28 ciclos por día, lo que corresponde a un ciclo recurrente cada 3-4 días. Otro pico destacado aparece en la frecuencia de aproximadamente 0.14 ciclos por día, lo que sugiere un ciclo semanal, consistente con patrones comunes de comportamiento de consumo. Además, se observa un tercer pico alrededor de 0.4 ciclos por día, lo que podría indicar ciclos más cortos, de aproximadamente 2-2.5 días.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">periodogram</span>

<span class="c1"># Calcular el espectro de potencia</span>
<span class="n">frecuencias</span><span class="p">,</span> <span class="n">potencia</span> <span class="o">=</span> <span class="n">periodogram</span><span class="p">(</span><span class="n">data5</span><span class="p">[</span><span class="s1">&#39;Ventas_Diferenciadas&#39;</span><span class="p">],</span> <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">)</span>

<span class="c1"># Visualizar el espectro de potencia</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">frecuencias</span><span class="p">,</span> <span class="n">potencia</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Espectro de Potencia - Identificación de Ciclos Dominantes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia (Ciclos por Día)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Densidad de Potencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/afa2a38610c1b86fcf9e9eb7a71c78b8b9084e611ebd3b21a097c1479b3463fa.png" src="_images/afa2a38610c1b86fcf9e9eb7a71c78b8b9084e611ebd3b21a097c1479b3463fa.png" />
</div>
</div>
<p>La gráfica del espectro de potencia muestra la densidad de potencia distribuida a lo largo de diferentes frecuencias en las ventas diarias diferenciadas. Se destacan picos importantes en frecuencias cercanas a 0.28, 0.14 y 0.4 ciclos por día, lo que sugiere la presencia de ciclos recurrentes cada 3-4 días, semanalmente y aproximadamente cada 2 días, respectivamente.</p>
</section>
<section id="deteccion-de-anomalias-y-eventos-extremos">
<h3>9. Detección de anomalías y eventos extremos<a class="headerlink" href="#deteccion-de-anomalias-y-eventos-extremos" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definir un umbral para identificar picos inusuales (por ejemplo, 3 desviaciones estándar)</span>
<span class="n">umbral_superior</span> <span class="o">=</span> <span class="n">data5</span><span class="p">[</span><span class="s1">&#39;Ventas_Diferenciadas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">data5</span><span class="p">[</span><span class="s1">&#39;Ventas_Diferenciadas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">umbral_inferior</span> <span class="o">=</span> <span class="n">data5</span><span class="p">[</span><span class="s1">&#39;Ventas_Diferenciadas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">data5</span><span class="p">[</span><span class="s1">&#39;Ventas_Diferenciadas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Identificar los puntos que superan estos umbrales</span>
<span class="n">anomalías</span> <span class="o">=</span> <span class="n">data5</span><span class="p">[(</span><span class="n">data5</span><span class="p">[</span><span class="s1">&#39;Ventas_Diferenciadas&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">umbral_superior</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">data5</span><span class="p">[</span><span class="s1">&#39;Ventas_Diferenciadas&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">umbral_inferior</span><span class="p">)]</span>

<span class="c1"># Visualización con anomalías marcadas</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data5</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">data5</span><span class="p">[</span><span class="s1">&#39;Ventas_Diferenciadas&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ventas Diferenciadas&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">anomalías</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">anomalías</span><span class="p">[</span><span class="s1">&#39;Ventas_Diferenciadas&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Anomalías&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">umbral_superior</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Umbral Superior&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">umbral_inferior</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Umbral Inferior&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Detección Visual de Anomalías en Ventas Diarias Diferenciadas&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Diferencia en la Cantidad Vendida&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Mostrar las fechas y valores de las anomalías detectadas</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--- Anomalías Detectadas ---&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">anomalías</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/da2d04b63fc04c5d933e16a32514dbf8302af33e9d75afb1950293f2360cc91c.png" src="_images/da2d04b63fc04c5d933e16a32514dbf8302af33e9d75afb1950293f2360cc91c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Anomalías Detectadas ---
             Ventas_Diferenciadas
InvoiceDate                      
2011-10-30                15783.0
2011-11-05               -17288.0
2011-11-06                17769.0
2011-11-12               -20264.0
2011-12-03               -15997.0
2011-12-05                16028.0
</pre></div>
</div>
</div>
</div>
<p>La gráfica muestra las anomalías en nuestras ventas diarias diferenciadas, con picos extremos marcados en rojo que superan los umbrales de ±15,000 unidades. Las anomalías detectadas se concentran entre finales de octubre y principios de diciembre de 2011, con variaciones significativas tanto positivas como negativas. Por ejemplo, el 6 de noviembre de 2011 se registró un aumento inusual de 17,769 unidades, seguido de una caída abrupta el 12 de noviembre de 20,264 unidades. Estos patrones podrían indicar devoluciones masivas, correcciones de inventario o eventos externos como promociones específicas durante este periodo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyod.models.knn</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNN</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Preparar los datos (convirtiendo a numpy array)</span>
<span class="n">datos</span> <span class="o">=</span> <span class="n">data5</span><span class="p">[</span><span class="s1">&#39;Ventas_Diferenciadas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Inicializar el modelo KNN</span>
<span class="n">modelo_knn</span> <span class="o">=</span> <span class="n">KNN</span><span class="p">()</span>

<span class="c1"># Ajustar el modelo a los datos</span>
<span class="n">modelo_knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span>

<span class="c1"># Obtener predicciones (1 = outlier, 0 = normal)</span>
<span class="n">predicciones</span> <span class="o">=</span> <span class="n">modelo_knn</span><span class="o">.</span><span class="n">labels_</span>

<span class="c1"># Agregar la columna de outliers al DataFrame original</span>
<span class="n">data5</span><span class="p">[</span><span class="s1">&#39;Outlier&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predicciones</span>

<span class="c1"># Filtrar los outliers detectados</span>
<span class="n">outliers_detectados</span> <span class="o">=</span> <span class="n">data5</span><span class="p">[</span><span class="n">data5</span><span class="p">[</span><span class="s1">&#39;Outlier&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Mostrar los outliers detectados</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--- Outliers Detectados con KNN (pyod) ---&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outliers_detectados</span><span class="p">[[</span><span class="s1">&#39;Ventas_Diferenciadas&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Outliers Detectados con KNN (pyod) ---
             Ventas_Diferenciadas
InvoiceDate                      
2009-12-19                -8752.0
2010-01-23                -8412.0
2010-03-07                 9344.0
2010-03-28                 9431.0
2010-04-02                -9584.0
...                           ...
2011-11-26               -12979.0
2011-12-03               -15997.0
2011-12-04                 9530.0
2011-12-05                16028.0
2011-12-09               -12964.0

[74 rows x 1 columns]
</pre></div>
</div>
</div>
</div>
<p>El análisis de outliers utilizando el modelo KNN de pyod reveló 74 anomalías en la serie de ventas diferenciadas, distribuidas en distintas fechas entre 2009 y 2011. Estos outliers incluyen tanto incrementos bruscos como caídas significativas en las ventas diarias, lo que sugiere la presencia de eventos inusuales como devoluciones masivas, errores en el registro de datos o picos de ventas asociados a promociones o temporadas especiales. La concentración de algunos de estos valores en fechas cercanas a finales de año podría estar relacionada con patrones estacionales, como las festividades de diciembre.</p>
<p>Las anomalías detectadas en la serie de ventas parecen coincidir con periodos típicos de alta actividad comercial, como temporadas festivas o eventos especiales que suelen influir en el comportamiento del consumidor. Estos picos y caídas en las ventas pueden deberse a promociones, descuentos o cambios estacionales que afectan la demanda de productos. Por lo tanto, no necesariamente representan errores en los datos, sino variaciones esperadas en función del contexto económico o social.</p>
</section>
<section id="resumen-y-recomendaciones">
<h3>10. Resumen y recomendaciones<a class="headerlink" href="#resumen-y-recomendaciones" title="Link to this heading">#</a></h3>
<p>En el análisis realizado, identificamos varios patrones clave en la serie temporal de ventas. Se detectó una clara tendencia no estacionaria, la cual fue confirmada mediante pruebas estadísticas como la ADF y la KPSS. Esta tendencia se estabilizó mediante la diferenciación, resultando en una serie estacionaria adecuada para modelización. Además, se observó estacionalidad en la frecuencia semanal y mensual, reflejada en los análisis de la Transformada de Fourier y el espectro de potencia. También se identificaron anomalías significativas, algunas de las cuales se asociaron a picos de ventas en fechas específicas, probablemente vinculadas a eventos comerciales o estacionales.</p>
<p>Como próximos pasos, proponemos aplicar diferentes modelos de serie de tiempo como ARIMA o SARIMA, que son adecuados para series estacionarias. Para manejar los valores atípicos, debemos evaluar su impacto en el modelo: si afectan negativamente, podrían ser suavizados mediante técnicas como medianas móviles o incluso eliminados si representan errores de registro. En cuanto a la no estacionariedad detectada inicialmente, la diferenciación ha sido efectiva, pero se pueden explorar transformaciones adicionales, como la logarítmica, para estabilizar aún más la varianza si es necesario. Por último, es recomendable contextualizar continuamente los picos de ventas con eventos externos para mejorar la precisión de las predicciones y ajustar estrategias comerciales.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="markdown.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Markdown Files</p>
      </div>
    </a>
    <a class="right-next"
       href="markdown-notebooks.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Notebooks with MyST Markdown</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion-y-contexto">1. Introducción y contexto</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-preliminar">2 Análisis preliminar</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspeccion-general">2.1 Inspección general</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estadistica-descriptiva">2.2 Estadística descriptiva</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-la-serie">3 Visualizacion de la serie</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-temporal">3.1 Visualizacion temporal</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-componentes">3.2 Análisis de componentes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#descomposicion-clasica-aditiva">Descomposición clásica (aditiva).</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#descomposicion-stl">Descomposicion STL</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-de-anomalias">Detección de anomalías</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estacionalidad-y-periodicidad">4 Estacionalidad y periodicidad</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-patrones-recurrentes">4.1. Análisis de patrones recurrentes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-tendencia">5 Análisis de tendencia</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agrupados-por-dias">Agrupados por dias</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agrupando-por-ventas-diarias">Agrupando por ventas diarias</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-la-media-y-varianza-en-submuestras-evaluar-si-cambian-con-el-tiempo">Visualización de la media y varianza en submuestras: Evaluar si cambian con el tiempo.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transformaciones-de-datos">6.2. Transformaciones de datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-multivariado">7. Análisis multivariado</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#identificacion-de-ciclos-y-frecuencias">8. Identificación de ciclos y frecuencias</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-de-anomalias-y-eventos-extremos">9. Detección de anomalías y eventos extremos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen-y-recomendaciones">10. Resumen y recomendaciones</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>